webpackJsonp([24],{142:function(t,a,e){"use strict";var i=e(3);e.n(i);a.a={data:function(){return{money:"",number:"",price:"",taocanname:"",comboType:"",introduction:"",effectDays:"",payType:1,washNum:"",washedNum:"",type:"weixin",openId:"",url2:"../../dist/select.png",env:"",wxopenid:""}},methods:{getData:function(){var t=this;this.$ajax.get("combo/get",{params:{id:t.$route.params.id}}).then(function(a){console.log(a),t.taocanname=a.data.data.name,t.price=a.data.data.price,t.introduction=a.data.data.introduction,t.effectDays=a.data.data.effectDays,t.comboType=a.data.data.comboType,t.washNum=a.data.data.washNum,t.washedNum=a.data.data.washedNum}).catch(function(t){})},alertpay:function(t){var a=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appid,timeStamp:t.time_stamp,nonceStr:t.nonce_str,package:t.packageStr,signType:"MD5",paySign:t.sign},function(t){"get_brand_wcpay_request:ok"==t.err_msg?a.$router.back(-1):"get_brand_wcpay_request:cancel"==t.err_msg?alert("已取消支付"):alert("支付异常")})},pay:function(t){var a={openId:this.openId,orderId:t};this.number?a.amount=this.number:a.amount=this.amount,1==this.env?(a.openId2=this.wxopenid,a.env=this.env):3==this.env&&(a.openId2="",a.env=this.env);var e=this;this.$ajax({method:"post",url:"wx/payment",data:this.$qs.stringify(a)}).then(function(t){1==e.env?e.alertpay(t.data.data):3==e.env&&(window.location.href=t.data.data.mweb_url)}).catch(function(t){})},goumai:function(){if(!this.number)return Object(i.Toast)("车牌不能为空"),!1;if(1!=this.comboType&&this.number.split("，").length>1)return Object(i.Toast)("月卡只能输入一个车牌号"),!1;var t=this;this.$ajax.get("combo/buyCombo",{params:{number:t.number.toUpperCase(),comboId:t.$route.params.id,openId:t.openId,payType:this.payType}}).then(function(a){t.pay(a.data.data)}).catch(function(t){})},changePic:function(t){switch(this.payType=t,t){case 1:this.type="weixin"}},is_weixin:function(){"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?this.env=1:this.env=3}},created:function(){var t=this;this.openId=localStorage.getItem("openid"),this.wxopenid=localStorage.getItem("wxopenid"),this.is_weixin(),this.openId?this.getData():(Object(i.Toast)("未登录,3秒后跳转"),setTimeout(function(){t.$router.replace({name:"myindex"})},3e3))},mounted:function(){var t=this;null!=this.openId&&this.$ajax({method:"post",url:"member/isLogin",data:this.$qs.stringify({openId:this.openId})}).then(function(a){console.log(a),"0000"==a.data.code?0==a.data.data&&(Object(i.Toast)("未登录,3秒后跳转"),setTimeout(function(){t.$router.replace({name:"myindex"})},3e3)):(Object(i.Toast)(a.data.msg),setTimeout(function(){t.$router.replace({name:"myindex"})},3e3))}).catch(function(a){setTimeout(function(){t.$router.replace({name:"myindex"})},3e3)})}}},197:function(t,a,e){var i=e(198);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e(2)("2e45ba34",i,!0,{})},198:function(t,a,e){a=t.exports=e(1)(!1),a.push([t.i,".btn-wrap[data-v-13aeac24]{height:1.30667rem;display:flex;justify-content:space-around;align-items:center;position:fixed;bottom:0;left:0;right:0}.btn-wrap .left[data-v-13aeac24]{padding-left:.34667rem;background:#333;width:68%}.btn-wrap .left[data-v-13aeac24],.btn-wrap .right[data-v-13aeac24]{box-sizing:border-box;display:flex;align-items:center;height:100%;color:#fff}.btn-wrap .right[data-v-13aeac24]{justify-content:center;width:100%;background:#db1e30}.wrap[data-v-13aeac24]{height:100%;background:#f5f5f5;font-size:.42667rem}.money[data-v-13aeac24]{display:flex;padding-left:.37333rem;background:#fff;height:1.2rem;align-items:center;margin-bottom:.26667rem}.money .left[data-v-13aeac24]{padding-right:.42667rem}.money .right[data-v-13aeac24]{color:red}.tip[data-v-13aeac24]{padding-left:.37333rem;color:red;font-size:.32rem;height:.53333rem;display:flex;align-items:center}.desc[data-v-13aeac24]{margin-bottom:.26667rem;height:2.66667rem;background:#fff;color:red;font-size:.42667rem}.cika[data-v-13aeac24],.yika[data-v-13aeac24]{margin-left:.37333rem}.youxiao[data-v-13aeac24]{margin-left:.37333rem;padding-top:.53333rem}.cishu[data-v-13aeac24]{margin-left:.37333rem}.label[data-v-13aeac24]{padding-left:.26667rem}.line[data-v-13aeac24]{height:.02667rem;background:#e0e0e0;width:99%;margin:0 auto}.top-wrap[data-v-13aeac24]{border-top-left-radius:.16rem;border-top-right-radius:.16rem}.bottom-wrap[data-v-13aeac24]{border-bottom-left-radius:.16rem;border-bottom-right-radius:.16rem}.item-wrap .left[data-v-13aeac24],.item-wrap[data-v-13aeac24]{display:flex;justify-content:space-between;align-items:center}.item-wrap[data-v-13aeac24]{padding:0 .05333rem;height:1.14667rem;background:#fff;font-size:.42667rem}.radio[data-v-13aeac24]{width:.48rem;height:.48rem}.yue-zhifu .left[data-v-13aeac24],.yue-zhifu .right[data-v-13aeac24]{padding-left:.26667rem}",""])},199:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"wrap"},[e("div",{staticClass:"money"},[e("div",{staticClass:"left"},[t._v(t._s(t.taocanname))]),t._v(" "),e("div",{staticClass:"right"},[t._v("￥"+t._s(t.price))])]),t._v(" "),e("mt-field",{attrs:{label:"车牌号",placeholder:"请输入车牌号，如粤QQ1234"},model:{value:t.number,callback:function(a){t.number=a},expression:"number"}}),t._v(" "),e("div",{staticClass:"tip"},[t._v("\n    "+t._s(1==t.comboType?"注：如果绑定多个车牌号，请用逗号分隔":"注：最多只能绑定一个车牌号")+"\n  ")]),t._v(" "),e("div",{staticClass:"desc"},[e("div",{staticClass:"youxiao"},[t._v("有效时间："+t._s(t.effectDays)+"天")]),t._v(" "),e("div",{staticClass:"cishu"},[1==t.comboType?e("div",[t._v("可洗次数："+t._s(t.washNum))]):t._e(),t._v(" "),2==t.comboType?e("div"):t._e()])]),t._v(" "),e("div",{staticClass:"yue-zhifu"},[e("div",{staticClass:"line"}),t._v(" "),e("div",{staticClass:"item-wrap bottom-wrap",on:{click:function(a){return t.changePic(1)}}},[t._m(0),t._v(" "),e("div",{staticClass:"right"},["weixin"===t.type?e("img",{staticClass:"radio",attrs:{src:"http://yima.52shuzhe.cn/dist/select.png",alt:""}}):t._e()])])]),t._v(" "),e("div",{staticClass:"btn-wrap"},[e("div",{staticClass:"right",on:{click:t.goumai}},[t._v("提交订单")])])],1)},n=[function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"left"},[i("img",{attrs:{src:e(200),width:"24",height:"24"}}),t._v(" "),i("span",{staticClass:"label"},[t._v("微信支付")])])}],r={render:i,staticRenderFns:n};a.a=r},200:function(t,a,e){t.exports=e.p+"weixinzhifu.png?43cda723261b2c2208524580dd415575"},78:function(t,a,e){"use strict";function i(t){e(197)}Object.defineProperty(a,"__esModule",{value:!0});var n=e(142),r=e(199),s=e(4),o=i,c=s(n.a,r.a,!1,o,"data-v-13aeac24",null);a.default=c.exports}});
//# sourceMappingURL=24.build.js.map?c903e8d21b2bad90a6ae