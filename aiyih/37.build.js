webpackJsonp([37],{156:function(e,t,n){"use strict";var o=n(3);n.n(o);t.a={data:function(){return{tip:"获取验证码",yanzhengcode:"",code:"",sessionId:"",openId:"",onoff:!1,phone:"",newusername:"",isWeixin:!1}},methods:{login:function(){if(!this.phone)return void Object(o.Toast)("手机号码不能为空");if(!this.code)return void Object(o.Toast)("验证码不能为空");o.Indicator.open("登录中...");var e=this;this.$ajax.get("member/login",{params:{openId:e.sessionId,phone:e.phone,smsCode:e.code}}).then(function(t){console.log(t);var n=t.data;switch(n.code){case"2001":o.Indicator.close(),Object(o.Toast)(n.msg);break;case"0000":o.Indicator.close(),e.refreshToken(e.phone,n.data.refreshToken,e.sessionId)}}).catch(function(e){})},refreshToken:function(e,t,n){var o=this;this.$ajax.get("member/refreshToken",{params:{openId:n,phone:e,refreshToken:t}}).then(function(e){var t=e.data;localStorage.setItem("openid",t.data.openId),localStorage.setItem("user",JSON.stringify(t.data)),o.$router.push({name:"myindex"})}).catch(function(e){})},is_weixin:function(){"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?this.isWeixin=!0:this.isWeixin=!1},getsessionId:function(){var e=this;o.Indicator.open({text:"登录初始化...",spinnerType:"fading-circle"}),this.$ajax({method:"get",url:"/member/getSessionId"}).then(function(t){console.log(t,"sessionId"),e.sessionId=t.data.data,o.Indicator.close()}).catch(function(e){o.Indicator.close()})},codeClick:function(){var e=/^1[3|4|5|7|8][0-9]{9}$/;if(!this.phone)return void Object(o.Toast)("手机号码不能为空");if(!e.test(this.phone))return void Object(o.Toast)("手机号码格式错误");if(!this.onoff){this.onoff=!0;var t=this;this.$ajax({method:"post",url:"captcha/sendSms",data:this.$qs.stringify({openId:t.sessionId,phone:t.phone})}).then(function(e){console.log(e,"获取验证码");var n=60,o=setInterval(function(){if(1==n)return t.tip="获取验证码",t.onoff=!1,void clearInterval(o);t.tip=--n+"秒后重新获取"},1e3)})}},getopenid:function(){var e=this;o.Indicator.open({text:"登录初始化...",spinnerType:"fading-circle"}),this.$ajax({method:"post",url:"wx/getOpenId",data:this.$qs.stringify({code:e.yanzhengcode})}).then(function(e){localStorage.setItem("wxopenid",e.data.data),o.Indicator.close()}).catch(function(e){o.Indicator.close()})}},created:function(){if(this.getsessionId(),"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)){this.isWeixin=!0;var e=new RegExp("(^|&)code=([^&]*)(&|$)"),t=window.location.search.substr(1).match(e);this.yanzhengcode=t[2],this.getopenid()}else this.isWeixin=!1},mounted:function(){}}},278:function(e,t,n){var o=n(279);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);n(2)("16715086",o,!0,{})},279:function(e,t,n){t=e.exports=n(1)(!1),t.push([e.i,".wrap[data-v-231fa990]{height:100%;background:#f5f5f5}.bottom-btn[data-v-231fa990]{width:9.28rem;background:-moz-linear-gradient(top,#ff8586,#d81618);background:-webkit-linear-gradient(top,#ff8586,#d81618);background:-o-linear-gradient(top,#ff8586,#d81618);background:linear-gradient(top,#ff8586,#d81618);font-size:.4rem;color:#fff;height:1.06667rem;border-radius:.21333rem;margin:.8rem auto 0}.bottom-btn[data-v-231fa990],.phone[data-v-231fa990]{display:flex;justify-content:center;align-items:center}.phone[data-v-231fa990]{height:2.08rem;font-size:.45333rem}.btn-code[data-v-231fa990]{color:#7a7979}footer[data-v-231fa990]{margin-top:.8rem;width:100%;height:.4rem;font-size:.34667rem;text-align:center;font-weight:500;color:#6d6d6d}",""])},280:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"phone"},[e._v("手机号登录")]),e._v(" "),n("mt-field",{attrs:{label:"手机号",type:"tel",placeholder:"请输入新的手机号"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),e._v(" "),n("mt-field",{staticClass:"getcode",attrs:{label:"验证码",type:"number",placeholder:"请输入验证码"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}},[n("span",{staticClass:"btn-code",on:{click:e.codeClick}},[e._v(e._s(e.tip))])]),e._v(" "),n("div",{staticClass:"bottom-btn",on:{click:e.login}},[e._v("登录")])],1)},i=[],a={render:o,staticRenderFns:i};t.a=a},93:function(e,t,n){"use strict";function o(e){n(278)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(156),a=n(280),s=n(4),r=o,c=s(i.a,a.a,!1,r,"data-v-231fa990",null);t.default=c.exports}});
//# sourceMappingURL=37.build.js.map?c903e8d21b2bad90a6ae